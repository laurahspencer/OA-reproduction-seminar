ggplotly(fert.data.3 %>%
ggplot(mapping=aes(x=log(egg.pre.exp.time), y=Perc.Fertilization, group=Phylum, col=Phylum, text=`Common name`)) +
geom_point(size=1.5, width=0.02) +
#facet_wrap(~Taxa) +
geom_smooth(method="lm", se=TRUE, aes(fill=Phylum)) +
ggtitle("Fertilization Rate ~ Egg pre-exposure minutes by phylum"))
fert.data.3$Phylum
levels(fert.data.3$Phylum)
fert.data.3$Phylum <- factor(fert.data.3$Phylum, levels = c("Echinodermata", "Mollusca","Cnidaria","Crustacean"))
levels(fert.data.3$Phylum)
# plot % fert ~ pH.experim by Phylum
ggplotly(fert.data.3 %>%
ggplot(mapping=aes(x=pH.experim, y=Perc.Fertilization, group=Phylum, col=Phylum, text=`Common name`)) +
geom_point(size=1.5, width=0.02) +
#facet_wrap(~Taxa) +
geom_smooth(method="lm", se=TRUE, aes(fill=Phylum)) +
ggtitle("Fertilization Rate ~ pH exposure by phylum"))
# plot % fert ~ pH.experim by Phylum
ggplotly(fert.data.3 %>%
ggplot(mapping=aes(x=Insemination.mins, y=Perc.Fertilization, group=Phylum, col=Phylum, text=`Common name`)) +
geom_point(size=1.5, width=0.02) +
#facet_wrap(~Taxa) +
geom_smooth(method="lm", se=TRUE, aes(fill=Phylum)) +
ggtitle("Fertilization Rate ~ Insemination minutes by phylum"))
# plot % fert ~ pH.experim by Phylum
ggplotly(fert.data.3 %>%
ggplot(mapping=aes(x=log(egg.pre.exp.time), y=Perc.Fertilization, group=Phylum, col=Phylum, text=`Common name`)) +
geom_point(size=1.5, width=0.02) +
#facet_wrap(~Taxa) +
geom_smooth(method="lm", se=TRUE, aes(fill=Phylum)) +
ggtitle("Fertilization Rate ~ Egg pre-exposure minutes by phylum"))
# plot % fert ~ pH.experim by Phylum
ggplotly(fert.data.3 %>%
ggplot(mapping=aes(x=log(Sperm.per.mL), y=Perc.Fertilization, group=Phylum, col=Phylum, text=`Common name`)) +
geom_point(size=1.5, width=0.02) +
#facet_wrap(~Taxa) +
geom_smooth(method="lm", se=TRUE, aes(fill=Phylum)) +
ggtitle("Fertilization Rate ~ sperm concentration (log-trans) by phylum"))
# plot % fert ~ pH.experim by Phylum
ggplotly(fert.data.3 %>%
ggplot(mapping=aes(x=log(Sperm.per.mL), y=Perc.Fertilization, group=Phylum, col=Phylum, text=`Common name`, shape=pH.group)) +
geom_point(size=1.5, width=0.02) +
#facet_wrap(~Taxa) +
geom_smooth(method="lm", se=TRUE, aes(fill=Phylum)) +
ggtitle("Fertilization Rate ~ sperm concentration (log-trans) by phylum"))
fert.data <- read_csv(here::here("fert-data.csv"))
fert.data.2 <-
fert.data %>%
dplyr::select(pH.experim, Perc.Fertilization,
Insemination.mins, Fert.success.mins, Sperm.pre.exp.time,
egg.pre.exp.time, pH.delta, Sperm.per.mL, sperm.egg, n.females, n.males) %>%
mutate_if(is.factor, as.numeric) %>%
mutate_if(is.character, as.numeric)
fert.data.3 <-
fert.data %>%
mutate_at(c("Phylum", "Common name", "Brooders/Spawniers", "Family", "Taxa", "Species") , as.factor)
fert.data.3$pH.group <- cut(fert.data.3$pH.experim,c(6,7.3,7.5,7.8, 8.2))
fert.data.3$Phylum <- factor(fert.data.3$Phylum, levels = c("Echinodermata", "Mollusca","Cnidaria","Crustacean"))
fert.data.4 <- fert.data.3[,c(1,4:5, 8:14, 16:19)] %>%
mutate_if(is.factor, as.numeric) %>% #convert factors to numeric factors
mutate_if(is.character, as.numeric)  #convert character column to numeric
# plot % fert ~ pH.experim by Phylum
ggplotly(fert.data.3 %>%
ggplot(mapping=aes(x=log(Sperm.per.mL), y=Perc.Fertilization, group=Phylum, col=Phylum, text=`Common name`, shape=pH.group)) +
geom_point(size=1.5, width=0.02) +
#facet_wrap(~Taxa) +
geom_smooth(method="lm", se=TRUE, aes(fill=Phylum)) +
ggtitle("Fertilization Rate ~ sperm concentration (log-trans) by phylum"))
# plot % fert ~ pH.experim by Phylum
ggplotly(fert.data.3 %>%
ggplot(mapping=aes(x=log(Sperm.per.mL+1), y=Perc.Fertilization, group=Phylum, col=Phylum, text=`Common name`, shape=pH.group)) +
geom_point(size=1.5, width=0.02) +
#facet_wrap(~Taxa) +
geom_smooth(method="lm", se=TRUE, aes(fill=Phylum)) +
ggtitle("Fertilization Rate ~ sperm concentration (log-trans) by phylum"))
ggplotly(fert.data.3 %>%
ggplot(mapping=aes(x=log(Sperm.per.mL+1), y=Perc.Fertilization, group=Phylum, col=Phylum, text=`Common name`)) +
geom_point(size=1.5, width=0.02) +
#facet_wrap(~Taxa) +
geom_smooth(method="lm", se=TRUE, aes(fill=Phylum)) +
ggtitle("Fertilization Rate ~ sperm concentration (log-trans) by phylum"))
ggplotly(fert.data.3 %>%
ggplot(mapping=aes(x=log(Sperm.per.mL+1), y=Perc.Fertilization, group=Phylum, col=Phylum, text=`Common name`, shape=pH.group)) +
geom_point(size=1.5, width=0.02) +
#facet_wrap(~Taxa) +
geom_smooth(method="lm", se=TRUE, aes(fill=Phylum)) +
ggtitle("Fertilization Rate ~ sperm concentration (log-trans) by phylum"))
ggplotly(fert.data.3 %>%
ggplot(mapping=aes(x=log(Sperm.per.mL+1), y=Perc.Fertilization, group=PhylumL:pH.group, col=Phylum:pH.group, text=`Common name`, shape=pH.group)) +
geom_point(size=1.5, width=0.02) +
#facet_wrap(~Taxa) +
geom_smooth(method="lm", se=TRUE, aes(fill=Phylum:pH.group)) +
ggtitle("Fertilization Rate ~ sperm concentration (log-trans) by phylum"))
ggplotly(fert.data.3 %>%
ggplot(mapping=aes(x=log(Sperm.per.mL+1), y=Perc.Fertilization, group=Phylum:pH.group, col=Phylum:pH.group, text=`Common name`, shape=pH.group)) +
geom_point(size=1.5, width=0.02) +
#facet_wrap(~Taxa) +
geom_smooth(method="lm", se=TRUE, aes(fill=Phylum:pH.group)) +
ggtitle("Fertilization Rate ~ sperm concentration (log-trans) by phylum"))
View(fert.data.3)
fert.data <- read_csv(here::here("fert-data.csv"))
require(here)
fert.data <- read_csv(here::here("fert-data.csv"))
dev.off()
knitr::opts_chunk$set(echo = TRUE)
require(here)
require(tidyverse)
require(plotly)
require(vegan)
require(cluster)
source(here::here("biostats.R"))
source(here::here("panelcor.R"))
getwd()
here::here("fert-data.csv")
fert.data <- read_csv(here::here("fert-data.csv"))
knitr::opts_chunk$set(echo = TRUE)
require(here)
require(tidyverse)
require(plotly)
require(vegan)
require(cluster)
source(here::here("biostats.R"))
source(here::here("panelcor.R"))
fert.data.4
View(fert.data.4)
dist.gower <- vegdist(fert.data.4, "gower")
spe.pcoa <- cmdscale(dist.gower, eig=T, add=T)
head(spe.pcoa$points, n=15)
head(spe.pcoa$eig, n=15)
hist(spe.pcoa$eig/sum(spe.pcoa$eig)*100)
plot(spe.pcoa$eig[1:100]/sum(spe.pcoa$eig)*100,type="b",lwd=2,col="blue",xlab= "Principal Component from PCoA", ylab="% variation explained", main="% variation explained by PCoA (blue) vs. random expectation (red)")
lines(bstick(100)*100,type="b",lwd=2,col="red")
ordiplot
ordiplot(spe.pcoa, choices = c(1, 2), type="text")
print(vec.sp<-envfit(spe.pcoa$points, k=45, fert.data.4, perm=1000, na.rm=T))
ordiplot(spe.pcoa, choices = c(1, 2), type="points", display="sites")
plot(vec.sp, p.max=.05, col="blue") # note, p.max = set p-value threshold for plotting vectors.
?ordiplot
ordiplot(spe.pcoa, choices = c(1, 2), type="points", display="sites", col=fert.data.4$Phylum)
ordiplot(spe.pcoa, choices = c(1, 2), type="points", display="sites", col=c("red","blue","green","purple")[fert.data.4$Phylum])
ordiplot(spe.pcoa, choices = c(1, 2), type="points", display="sites", col=c("red","blue","green","purple")[fert.data.4$Phylum])
c("red","blue","green","purple")[fert.data.4$Phylum]
ordiplot(spe.pcoa, choices = c(1, 2), type="points", col=c("red","blue","green","purple")[fert.data.4$Phylum])
pl <- ordiplot(spe.pcoa, type = "none")
points(pl, "sites", pch=21,
col=c("red","blue","green","purple")[fert.data.4$Phylum], bg="yellow")
text(pl, "species", col="blue", cex=0.9)
pl <- ordiplot(spe.pcoa, type = "none")
points(pl, "sites", pch=21,
bg=c("red","blue","green","purple")[fert.data.4$Phylum])
text(pl, "species", col="blue", cex=0.9)
pl <- ordiplot(spe.pcoa, type = "none")
points(pl, "sites", pch=21,
bg=c("red","blue","green","purple")[fert.data.4$Phylum])
#text(pl, "species", col="blue", cex=0.9)
plot(vec.sp, p.max=.05, col="gray") # note, p.max = set p-value threshold for plotting vectors.
pl <- ordiplot(spe.pcoa, type = "none")
points(pl, "sites", pch=21,
bg=c("red","blue","green","purple")[fert.data.4$Phylum])
#text(pl, "species", col="blue", cex=0.9)
plot(vec.sp, p.max=.01, col="black") # note, p.max = set p-value threshold for plotting vectors.
fert.data.4$pH.group <- cut(fert.data.4$pH.experim,c(6,7.3,7.5,7.8, 8.2))
fert.data.4$pH.experim
fert.data.3
str(fert.data.3$pH.group <- cut(fert.data.3$pH.experim,c(6,7.3,7.5,7.8, 8.2))
)
str(fert.data.3)
fert.data.3[,c(1,4:5, 7:14, 16:19, 26)]
fert.data.4 <- fert.data.3[,c(1,4:5, 7:14, 16:19)] %>%
mutate_if(is.factor, as.numeric) %>% #convert factors to numeric factors
mutate_if(is.character, as.numeric)  #convert character column to numeric
fert.data.4$pH.group <- cut(fert.data.4$pH.experim, c(6,7.3,7.5,7.8, 8.2))
fert.data.4$pH.group
fert.data.4$pH.group <- cut(fert.data.4$pH.experim, c(6,7.3,7.5,7.8, 8.2))
dist.gower <- vegdist(fert.data.4, "gower")
fert.data.4 <- fert.data.3[,c(1,4:5, 7:14, 16:19)] %>%
mutate_if(is.factor, as.numeric) %>% #convert factors to numeric factors
mutate_if(is.character, as.numeric)  #convert character column to numeric
dist.gower <- vegdist(fert.data.4, "gower")
spe.pcoa <- cmdscale(dist.gower, eig=T, add=T)
plot(spe.pcoa$eig[1:100]/sum(spe.pcoa$eig)*100,type="b",lwd=2,col="blue",xlab= "Principal Component from PCoA", ylab="% variation explained", main="% variation explained by PCoA (blue) vs. random expectation (red)")
lines(bstick(100)*100,type="b",lwd=2,col="red")
ordiplot(spe.pcoa, choices = c(1, 2), type="text")
print(vec.sp<-envfit(spe.pcoa$points, k=45, fert.data.4, perm=1000, na.rm=T))
ordiplot(spe.pcoa, choices = c(1, 2), col=c("red","blue","green","purple")[fert.data.4$Phylum])
fert.data.4$pH.group <- cut(fert.data.4$pH.experim, c(6,7.3,7.5,7.8, 8.2))
pl <- ordiplot(spe.pcoa, type = "none")
points(pl, "sites", pch=c(21,22,23,24)[fert.data.4$pH.group],
bg=c("red","blue","green","purple")[fert.data.4$Phylum])
#text(pl, "species", col="blue", cex=0.9)
plot(vec.sp, p.max=.01, col="black") # note, p.max = set p-value threshold for plotting vectors.
ggplotly(points(pl, "sites", pch=c(21,22,23,24)[fert.data.4$pH.group],
bg=c("red","blue","green","purple")[fert.data.4$Phylum]))
pl <- ordiplot(spe.pcoa, type = "none")
pl <- ordiplot(spe.pcoa, type = "none")
points(pl, "sites", pch=c(21,22,23,24)[fert.data.4$pH.group],
bg=c("red","blue","green","purple")[fert.data.4$Phylum])
plot(vec.sp, p.max=.01, col="black") # note, p.max = set p-value threshold for plotting vectors.
pl <- ordiplot(spe.pcoa, type = "none", xlim = c(-1,1.5))
points(pl, "sites", pch=c(21,22,23,24)[fert.data.4$pH.group],
bg=c("red","blue","green","purple")[fert.data.4$Phylum])
plot(vec.sp, p.max=.01, col="black") # note, p.max = set p-value threshold for plotting vectors.
pl <- ordiplot(spe.pcoa, type = "none", xlim = c(-1,1.5), ylim = c(-1, 1.7))
points(pl, "sites", pch=c(21,22,23,24)[fert.data.4$pH.group],
bg=c("red","blue","green","purple")[fert.data.4$Phylum])
plot(vec.sp, p.max=.01, col="black") # note, p.max = set p-value threshold for plotting vectors.
ordiplot(spe.pcoa, type = "none", xlim = c(-1,1.5), ylim = c(-1, 1.7))
ordiplot(spe.pcoa, type = "none", xlim = c(-1,1.5), ylim = c(-1, 1.7))
ordiplot(spe.pcoa, type = "none",  xlim = (-1,1.5), ylim = (-1, 1.7))
ordiplot(spe.pcoa, type = "none",  xlim = c(-1,1.5), ylim = c(-1, 1.7))
pl <- ordiplot(spe.pcoa, type = "none",  xlim = c(-1,1.5))
pl <- ordiplot(spe.pcoa, type = "none",  xlim = c(-1,1.5))
points(pl, "sites", pch=c(21,22,23,24)[fert.data.4$pH.group],
bg=c("red","blue","green","purple")[fert.data.4$Phylum])
pl <- ordiplot(spe.pcoa, type = "none",  xlim = c(-1,1.5))
points(pl, "sites", pch=c(21,22,23,24)[fert.data.4$pH.group],
bg=c("red","blue","green","purple")[fert.data.4$Phylum])
plot(vec.sp, p.max=.01, col="black") # note, p.max = set p-value threshold for plotting vectors.
print(vec.sp<-envfit(spe.pcoa$points, k=45, fert.data.4, perm=1000, na.rm=T))
ordiplot(spe.pcoa, choices = c(1, 2), col=c("red","blue","green","purple")[fert.data.4$Phylum])
pl <- ordiplot(spe.pcoa, type = "none",  xlim = c(-1,1.5))
points(pl, "sites", pch=c(21,22,23,24)[fert.data.4$pH.group],
bg=c("red","blue","green","purple")[fert.data.4$Phylum])
plot(vec.sp, p.max=.01, col="black") # note, p.max = set p-value threshold for plotting vectors.
pl <- ordiplot(spe.pcoa, type = "none",  xlim = c(-1,1.5))
points(pl, "sites", pch=c(21,22,23,24)[fert.data.4$pH.group],
bg=c("red","blue","green","purple")[fert.data.4$Phylum])
plot(vec.sp, p.max=.01, col="black") # note, p.max = set p-value threshold for plotting vectors.
legend(x="topright", legend = levels(fert.data.4$Phylum), col=c("red","blue","green", "purple"), pch=c(21,22,23,24)[fert.data.4$pH.group])
legend(x="topright", legend = levels(fert.data.4$Phylum), col=c("red","blue","green", "purple"), pch=c(21,22,23,24)[fert.data.4$pH.group])
pl <- ordiplot(spe.pcoa, type = "none",  xlim = c(-1,1.5))
points(pl, "sites", pch=c(21,22,23,24)[fert.data.4$pH.group],
bg=c("red","blue","green","purple")[fert.data.4$Phylum])
plot(vec.sp, p.max=.01, col="black") # note, p.max = set p-value threshold for plotting vectors.
legend(x="topright", legend = levels(fert.data.4$Phylum), col=c("red","blue","green", "purple"))
pl <- ordiplot(spe.pcoa, type = "none",  xlim = c(-1,1.5))
points(pl, "sites", pch=c(21,22,23,24)[fert.data.4$pH.group],
bg=c("red","blue","green","purple")[fert.data.4$Phylum])
plot(vec.sp, p.max=.01, col="black") # note, p.max = set p-value threshold for plotting vectors.
legend(x="topright", legend = levels(fert.data.4$Phylum), col=c("red","blue","green", "purple"))
levels(fert.data.4$Phylum)
levels(fert.data.2$Phylum)
levels(fert.data.3$Phylum)
pl <- ordiplot(spe.pcoa, type = "none",  xlim = c(-1,1.5))
points(pl, "sites", pch=c(21,22,23,24)[fert.data.4$pH.group],
bg=c("red","blue","green","purple")[fert.data.4$Phylum])
plot(vec.sp, p.max=.01, col="black") # note, p.max = set p-value threshold for plotting vectors.
legend(x="topright", legend = levels(fert.data.3$Phylum), col=c("red","blue","green", "purple"))
pch=c(21,22,23,24)[fert.data.4$pH.group]
ordiplot(type = "none",  xlim = c(-1,1.5), ylim = c(-1,1.7))
plot(spe.pcoa, type = "none",  xlim = c(-1,1.5))
ordiplot(spe.pcoa, type = "none",  xlim = c(-1,1.5))
ordiplot(spe.pcoa, type = "none",  xlim = c(-1,1.5))
points(pl, "sites", pch=c(21,22,23,24)[fert.data.4$pH.group],
bg=c("red","blue","green","purple")[fert.data.4$Phylum])
pl <- ordiplot(spe.pcoa, type = "none",  xlim = c(-1,1.5))
points(pl, "sites", pch=c(21,22,23,24)[fert.data.4$pH.group],
bg=c("red","blue","green","purple")[fert.data.4$Phylum])
plot(vec.sp, p.max=.01, col="black") # note, p.max = set p-value threshold for plotting vectors.
legend(x="topright", legend = levels(fert.data.3$Phylum), col=c("red","blue","green", "purple"))
pch=c(21,22,23,24)[fert.data.4$pH.group]
pl <- ordiplot(spe.pcoa, type = "none",  xlim = c(-1,1.5))
points(pl, "sites", cex=0.8, pch=c(21,22,23,24)[fert.data.4$pH.group],
bg=c("red","blue","green","purple")[fert.data.4$Phylum])
plot(vec.sp, p.max=.01, col="black") # note, p.max = set p-value threshold for plotting vectors.
str(fert.data.3)
fert.data.4 <- fert.data.3[,c(1,5,7:9,11,12,16:19)] %>%
mutate_if(is.factor, as.numeric) %>% #convert factors to numeric factors
mutate_if(is.character, as.numeric)  #convert character column to numeric
fert.data.4
dist.gower <- vegdist(fert.data.4, "gower")
spe.pcoa <- cmdscale(dist.gower, eig=T, add=T)
hist(spe.pcoa$eig/sum(spe.pcoa$eig)*100)
plot(spe.pcoa$eig[1:100]/sum(spe.pcoa$eig)*100,type="b",lwd=2,col="blue",xlab= "Principal Component from PCoA", ylab="% variation explained", main="% variation explained by PCoA (blue) vs. random expectation (red)")
lines(bstick(100)*100,type="b",lwd=2,col="red")
ordiplot(spe.pcoa, choices = c(1, 2), type="text")
print(vec.sp<-envfit(spe.pcoa$points, k=45, fert.data.4, perm=1000, na.rm=T))
fert.data.4$pH.group <- cut(fert.data.4$pH.experim, c(6,7.3,7.5,7.8, 8.2))
pl <- ordiplot(spe.pcoa, type = "none",  xlim = c(-1,1.5))
points(pl, "sites", cex=0.8, pch=c(21,22,23,24)[fert.data.4$pH.group],
bg=c("red","blue","green","purple")[fert.data.4$Phylum])
plot(vec.sp, p.max=.01, col="black") # note, p.max = set p-value threshold for plotting vectors.
pdf(file = "fert.PCoA.pdf", width = 9, height = 8)
pl <- ordiplot(spe.pcoa, type = "none",  xlim = c(-1,1.5))
points(pl, "sites", cex=0.8, pch=c(21,22,23,24)[fert.data.4$pH.group],
bg=c("red","blue","green","purple")[fert.data.4$Phylum])
plot(vec.sp, p.max=.01, col="black") # note, p.max = set p-value threshold for plotting vectors.
dev.off()
pdf(file = "fert.PCoA.pdf", width = 9, height = 8)
pl <- ordiplot(spe.pcoa, type = "none",  xlim = c(-1,1.5))
points(pl, "sites", cex=0.8, pch=c(21,22,23,24)[fert.data.4$pH.group],
bg=c("red","blue","green","purple")[fert.data.4$Phylum])
plot(vec.sp, p.max=.01, col="black") # note, p.max = set p-value threshold for plotting vectors.
dev.off()
c(21,22,23,24)[fert.data.4$pH.group]
pl <- ordiplot(spe.pcoa, type = "none",  xlim = c(-1,1.5))
points(pl, "sites", cex=0.8, pch=c(21,22,23,24)[fert.data.4$pH.group],
bg=c("red","blue","green","purple")[fert.data.4$Phylum])
plot(vec.sp, p.max=.01, col="black") # note, p.max = set p-value threshold for plotting vectors.
#dev.off()
legend(x="topright", legend = levels(fert.data.3$Phylum), col=c("red","blue","green", "purple"), pch=c(21,22,23,24))
pl <- ordiplot(spe.pcoa, type = "none",  xlim = c(-1,1.5))
points(pl, "sites", cex=0.8, pch=c(21,22,23,24)[fert.data.4$pH.group],
bg=c("red","blue","green","purple")[fert.data.4$Phylum])
plot(vec.sp, p.max=.01, col="black") # note, p.max = set p-value threshold for plotting vectors.
#dev.off()
legend(x="topright", legend = levels(fert.data.4$Phylum), col=c("red","blue","green", "purple"), pch=21)
pl <- ordiplot(spe.pcoa, type = "none",  xlim = c(-1,1.5))
points(pl, "sites", cex=0.8, pch=c(21,22,23,24)[fert.data.4$pH.group],
bg=c("red","blue","green","purple")[fert.data.4$Phylum])
plot(vec.sp, p.max=.01, col="black") # note, p.max = set p-value threshold for plotting vectors.
#dev.off()
legend(x="topright", legend = levels(fert.data.4$Phylum), col=c("red","blue","green", "purple"), pch=rep(21, times=4))
pl <- ordiplot(spe.pcoa, type = "none",  xlim = c(-1,1.5))
points(pl, "sites", cex=0.8, pch=c(21,22,23,24)[fert.data.4$pH.group],
bg=c("red","blue","green","purple")[fert.data.4$Phylum])
plot(vec.sp, p.max=.01, col="black") # note, p.max = set p-value threshold for plotting vectors.
#dev.off()
legend(x="topright", legend = levels(fert.data.4$Phylum), col=c("red","blue","green", "purple"))
pl <- ordiplot(spe.pcoa, type = "none",  xlim = c(-1,1.5))
points(pl, "sites", cex=0.8, pch=c(21,22,23,24)[fert.data.4$pH.group],
bg=c("red","blue","green","purple")[fert.data.4$Phylum])
plot(vec.sp, p.max=.01, col="black") # note, p.max = set p-value threshold for plotting vectors.
#dev.off()
legend(x="topright", legend = levels(fert.data.4$Phylum), col=c("red","blue","green", "purple"), pch=c(21,22,23,24))
pl <- ordiplot(spe.pcoa, type = "none",  xlim = c(-1,1.5))
points(pl, "sites", cex=0.8, pch=c(21,22,23,24)[fert.data.4$pH.group],
bg=c("red","blue","green","purple")[fert.data.4$Phylum])
plot(vec.sp, p.max=.01, col="black") # note, p.max = set p-value threshold for plotting vectors.
#dev.off()
legend(x="topright", legend = levels(fert.data.3$Phylum), col=c("red","blue","green", "purple"), pch=c(21,22,23,24))
pl <- ordiplot(spe.pcoa, type = "none",  xlim = c(-1,1.5))
points(pl, "sites", cex=0.8, pch=c(21,22,23,24)[fert.data.4$pH.group],
bg=c("red","blue","green","purple")[fert.data.4$Phylum])
plot(vec.sp, p.max=.01, col="black") # note, p.max = set p-value threshold for plotting vectors.
#dev.off()
legend(x="topright", legend = levels(fert.data.3$Phylum), col=c("red","blue","green", "purple"), pch=c(16,16,16,16))
pl <- ordiplot(spe.pcoa, type = "none",  xlim = c(-1,1.5))
points(pl, "sites", cex=0.8, pch=c(21,22,23,24)[fert.data.4$pH.group],
bg=c("red","blue","green","purple")[fert.data.4$Phylum])
plot(vec.sp, p.max=.01, col="black") # note, p.max = set p-value threshold for plotting vectors.
#dev.off()
legend(x="topright", legend = levels(fert.data.3$Phylum), col=c("red","blue","green", "purple"), pch=c(21,21,21,21))
pl <- ordiplot(spe.pcoa, type = "none",  xlim = c(-1,1.5))
points(pl, "sites", cex=0.8, pch=c(21,22,23,24)[fert.data.4$pH.group],
bg=c("red","blue","green","purple")[fert.data.4$Phylum])
plot(vec.sp, p.max=.01, col="black") # note, p.max = set p-value threshold for plotting vectors.
#dev.off()
legend(x="topright", legend = levels(fert.data.3$Phylum), bg=c("red","blue","green", "purple"), pch=c(21,21,21,21))
pl <- ordiplot(spe.pcoa, type = "none",  xlim = c(-1,1.5))
points(pl, "sites", cex=0.8, pch=c(21,22,23,24)[fert.data.4$pH.group],
bg=c("red","blue","green","purple")[fert.data.4$Phylum])
plot(vec.sp, p.max=.01, col="black") # note, p.max = set p-value threshold for plotting vectors.
#dev.off()
legend(x="topright", legend = levels(fert.data.3$Phylum), col=c("red","blue","green", "purple"), bg="black", pch=c(16,16,16,16))
pl <- ordiplot(spe.pcoa, type = "none",  xlim = c(-1,1.5))
points(pl, "sites", cex=0.8, pch=c(21,22,23,24)[fert.data.4$pH.group],
bg=c("red","blue","green","purple")[fert.data.4$Phylum])
plot(vec.sp, p.max=.01, col="black") # note, p.max = set p-value threshold for plotting vectors.
#dev.off()
legend(x="topright", legend = levels(fert.data.3$Phylum), col=c("red","blue","green", "purple"), pch=c(16,16,16,16))
pl <- ordiplot(spe.pcoa, type = "none",  xlim = c(-1,1.5))
points(pl, "sites", cex=0.8, pch=c(21,22,23,24)[fert.data.4$pH.group],
bg=c("red","blue","green","purple")[fert.data.4$Phylum])
plot(vec.sp, p.max=.01, col="black") # note, p.max = set p-value threshold for plotting vectors.
#dev.off()
legend(x="topright", legend = levels(fert.data.3$Phylum), col=c("red","blue","green", "purple"), pch=c(16,16,16,16))
legend(x="bottomright", legend = levels(fert.data.3$pH.group),pch=c(21,22,23,24))
pl <- ordiplot(spe.pcoa, type = "none",  xlim = c(-1,1.5))
points(pl, "sites", cex=0.8, pch=c(21,22,23,24)[fert.data.4$pH.group],
bg=c("red","blue","green","purple")[fert.data.4$Phylum])
plot(vec.sp, p.max=.01, col="black") # note, p.max = set p-value threshold for plotting vectors.
#dev.off()
legend(x="topright", legend = levels(fert.data.3$Phylum), col=c("red","blue","green", "purple"), pch=c(16,16,16,16))
legend(x="right", legend = levels(fert.data.3$pH.group),pch=c(21,22,23,24))
pdf(file = "fert.PCoA.pdf", width = 9, height = 8)
pl <- ordiplot(spe.pcoa, type = "none",  xlim = c(-1,1.5))
points(pl, "sites", cex=0.8, pch=c(21,22,23,24)[fert.data.4$pH.group],
bg=c("red","blue","green","purple")[fert.data.4$Phylum])
plot(vec.sp, p.max=.01, col="black") # note, p.max = set p-value threshold for plotting vectors.
legend(x="topright", legend = levels(fert.data.3$Phylum), col=c("red","blue","green", "purple"), pch=c(16,16,16,16))
legend(x="right", legend = levels(fert.data.3$pH.group),pch=c(21,22,23,24))
dev.off()
str(fert.data.3)
fert.data.4
str(fert.data.4)
str(fert.data.4[-1:-2])
str(fert.data.4[-1:-2])
str(fert.data.4[c(-1,-2,-10)])
str(fert.data.4[c(-1,-2,-11)])
str(fert.data.4)
str(fert.data.4[c(-1,-2,-12)])
fert.data.4
dist.gower2 <- vegdist(fert.data.4[c(-1,-2,-12)], "gower")
spe.pcoa2 <- cmdscale(dist.gower2, eig=T, add=T)
pl2 <- ordiplot(spe.pcoa2, type = "none",  xlim = c(-1,1.5))
points(pl, "sites", cex=0.8, pch=c(21,22,23,24)[fert.data.4$pH.group],
bg=c("red","blue","green","purple")[fert.data.4$Phylum])
plot(vec.sp2, p.max=.01, col="black") # note, p.max = set p-value threshold for plotting vectors.
legend(x="topright", legend = levels(fert.data.4$Phylum), col=c("red","blue","green", "purple"), pch=c(16,16,16,16))
print(vec.sp2<-envfit(spe.pcoa2$points, k=45, fert.data.4[c(-1,-2,-12)], perm=1000, na.rm=T))
pl2 <- ordiplot(spe.pcoa2, type = "none",  xlim = c(-1,1.5))
points(pl2, "sites", cex=0.8, pch=c(21,22,23,24)[fert.data.4$pH.group],
bg=c("red","blue","green","purple")[fert.data.4$Phylum])
plot(vec.sp2, p.max=.01, col="black") # note, p.max = set p-value threshold for plotting vectors.
str(fert.data.4)
dist.gower2 <- vegdist(fert.data.4[c(-1,-2,-3,-12)], "gower")
dist.gower2
fert.data.4[c(-1,-2,-3,-12)]
dist.gower2 <- vegdist(fert.data.4[c(-1,-2,-3,-12)], "gower")
spe.pcoa2 <- cmdscale(dist.gower2, eig=T, add=T)
dist.gower2 <- vegdist(fert.data.4[c(-1,-2,-12)], "gower")
spe.pcoa2 <- cmdscale(dist.gower2, eig=T, add=T)
fert.data.4[c(-1,-2,-3,-12)]
fert.data.4[c(-1:-3,-12)]
dist.gower2 <- vegdist(fert.data.4[c(-1:-3,-12)], "gower")
View(dist.gower2)
str(dist.gower2)
summary(dist.gower2)
fert.data.4[4:11]
dist.gower2 <- vegdist(fert.data.4[4:11], "gower")
dist.gower2 <- vegdist(fert.data.4[4:11], "gower", na.rm = TRUE)
spe.pcoa2 <- cmdscale(dist.gower2, eig=T, add=T)
spe.pcoa2
print(vec.sp2<-envfit(spe.pcoa2$points, k=45, fert.data.4[c(-1,-2,-3,-12)], perm=1000, na.rm=T))
pl2 <- ordiplot(spe.pcoa2, type = "none",  xlim = c(-1,1.5))
points(pl2, "sites", cex=0.8, pch=c(21,22,23,24)[fert.data.4$pH.group],
bg=c("red","blue","green","purple")[fert.data.4$Phylum])
plot(vec.sp2, p.max=.01, col="black") # note, p.max = set p-value threshold for plotting vectors.
dist.gower2 <- vegdist(fert.data.4[4:11], "gower", na.rm = F)
spe.pcoa2 <- cmdscale(dist.gower2, eig=T, add=T)
dist.gower2 <- vegdist(fert.data.4[4:11], "gower", na.rm = T)
spe.pcoa2 <- cmdscale(dist.gower2, eig=T, add=T)
dist.gower2 <- vegdist(fert.data.4[4:11], "gower", na.rm = T)
spe.pcoa2 <- cmdscale(dist.gower2, eig=T, add=T)
print(vec.sp2<-envfit(spe.pcoa2$points, k=45, fert.data.4[c(4:11)], perm=1000, na.rm=T))
rm(spe.pcoa2)
dist.gower2 <- vegdist(fert.data.4[4:11], "gower", na.rm = T)
spe.pcoa2 <- cmdscale(dist.gower2, eig=T, add=T)
dist.gower2 <- vegdist(fert.data.4[4:11], "gower", na.rm = F)
fert.data.4
vegdist(fert.data.4[1,4:11], "gower", na.rm = F)
dist.gower2 <- vegdist(fert.data.4[1,4:11], "gower", na.rm = F)
spe.pcoa2 <- cmdscale(dist.gower2, eig=T, add=T)
spe.pcoa <- cmdscale(dist.gower, eig=T, add=T, k=2)
head(spe.pcoa$points, n=15)
head(spe.pcoa$eig, n=15)
hist(spe.pcoa$eig/sum(spe.pcoa$eig)*100)
plot(spe.pcoa$eig[1:100]/sum(spe.pcoa$eig)*100,type="b",lwd=2,col="blue",xlab= "Principal Component from PCoA", ylab="% variation explained", main="% variation explained by PCoA (blue) vs. random expectation (red)")
lines(bstick(100)*100,type="b",lwd=2,col="red")
print(vec.sp<-envfit(spe.pcoa$points, k=45, fert.data.4, perm=1000, na.rm=T))
fert.data.4$pH.group <- cut(fert.data.4$pH.experim, c(6,7.3,7.5,7.8, 8.2))
pl <- ordiplot(spe.pcoa, type = "none",  xlim = c(-1,1.5))
points(pl, "sites", cex=0.8, pch=c(21,22,23,24)[fert.data.4$pH.group],
bg=c("red","blue","green","purple")[fert.data.4$Phylum])
plot(vec.sp, p.max=.01, col="black") # note, p.max = set p-value threshold for plotting vectors.
legend(x="topright", legend = levels(fert.data.3$Phylum), col=c("red","blue","green", "purple"), pch=c(16,16,16,16))
legend(x="right", legend = levels(fert.data.3$pH.group),pch=c(21,22,23,24))
dist.gower2 <- vegdist(fert.data.4[1,4:11], "gower", k=2, na.rm = F)
spe.pcoa2 <- cmdscale(dist.gower2, eig=T, add=T)
spe.pcoa2 <- cmdscale(dist.gower2, k=2, eig=T, add=T)
dist.gower2 <- vegdist(fert.data.4[1,4:11], "gower", na.rm = F)
spe.pcoa2 <- cmdscale(dist.gower2, k=2, eig=T, add=T)
spe.pcoa2 <- cmdscale(na.omit(dist.gower2), k=2, eig=T, add=T)
na.omit(dist.gower2)
dist.gower2
dist.gower2 <- vegdist(fert.data.4[1,4:11], "gower", na.rm = F)
dist.gower2
dist.gower2 <- vegdist(fert.data.4[c(1,4:11)], "gower", na.rm = F)
dist.gower2
spe.pcoa2 <- cmdscale(dist.gower2, k=2, eig=T, add=T)
dist.gower2 <- vegdist(fert.data.4[c(4:11)], "gower", na.rm = F)
spe.pcoa2 <- cmdscale(dist.gower2, k=2, eig=T, add=T)
dist.gower2 <- vegdist(fert.data.4[c(1,4:11)], "gower", na.rm = F)
dist.gower2 <- vegdist(fert.data.4[c(1,4:11)], "gower", na.rm = F)
spe.pcoa2 <- cmdscale(dist.gower2, k=2, eig=T, add=T)
print(vec.sp2<-envfit(spe.pcoa2$points, k=45, fert.data.4[c(4:11)], perm=1000, na.rm=T))
pl2 <- ordiplot(spe.pcoa2, type = "none",  xlim = c(-1,1.5))
points(pl2, "sites", cex=0.8, pch=c(21,22,23,24)[fert.data.4$pH.group],
bg=c("red","blue","green","purple")[fert.data.4$Phylum])
plot(vec.sp2, p.max=.01, col="black") # note, p.max = set p-value threshold for plotting vectors.
dist.gower2 <- vegdist(fert.data.4[c(4:11)], "gower", na.rm = F)
dist.gower2
spe.pcoa2 <- cmdscale(dist.gower2, k=2, eig=T, add=T)
dist.gower2
na.omit(dist.gower2)
dist.gower2 <- vegdist(fert.data.4[c(4:11)], "gower", na.rm = F)
spe.pcoa2 <- cmdscale(na.omit(dist.gower2), k=2, eig=T, add=T)
View(fert.data.4[c(4:11)])
fert.data.4
dist.gower2 <- vegdist(fert.data.4[c(2,4:11)], "gower", na.rm = F)
spe.pcoa2 <- cmdscale(dist.gower2, k=2, eig=T, add=T)
print(vec.sp2<-envfit(spe.pcoa2$points, k=45, fert.data.4[c(2,4:11)], perm=1000, na.rm=T))
pl2 <- ordiplot(spe.pcoa2, type = "none",  xlim = c(-1,1.5))
points(pl2, "sites", cex=0.8, pch=c(21,22,23,24)[fert.data.4$pH.group],
bg=c("red","blue","green","purple")[fert.data.4$Phylum])
plot(vec.sp2, p.max=.01, col="black") # note, p.max = set p-value threshold for plotting vectors.
pdf(file = "fert.PCoA-nopH.pdf", width = 9, height = 8)
pl2 <- ordiplot(spe.pcoa2, type = "none",  xlim = c(-1,1.5))
points(pl2, "sites", cex=0.8, pch=c(21,22,23,24)[fert.data.4$pH.group],
bg=c("red","blue","green","purple")[fert.data.4$Phylum])
plot(vec.sp2, p.max=.01, col="black") # note, p.max = set p-value threshold for plotting vectors.
legend(x="topright", legend = levels(fert.data.4$Phylum), col=c("red","blue","green", "purple"), pch=c(16,16,16,16))
fert.data.4$Phylum
pdf(file = "fert.PCoA-nopH.pdf", width = 9, height = 8)
pl2 <- ordiplot(spe.pcoa2, type = "none",  xlim = c(-1,1.5))
points(pl2, "sites", cex=0.8, pch=c(21,22,23,24)[fert.data.4$pH.group],
bg=c("red","blue","green","purple")[fert.data.4$Phylum])
plot(vec.sp2, p.max=.01, col="black") # note, p.max = set p-value threshold for plotting vectors.
legend(x="topright", legend = levels(fert.data.3$Phylum), col=c("red","blue","green", "purple"), pch=c(16,16,16,16))
legend(x="right", legend = levels(fert.data.3$pH.group),pch=c(21,22,23,24))
dev.off()
