geom_line(data = predict.mollusc.df, aes(x=pH_delta, y=fit),
col="gray45", linetype=2) +
theme(legend.position = "none") +
geom_label(aes(x=-1.5, y=0.8), label=paste("Model with full pH range: χ2 p-value =",
round(Anova(model.mollusc)[,"Pr(>Chisq)"], digits =4), sep=" "),
colour="gray40", size=3, alpha=0.3, fill="#fff2ae") +
geom_ribbon(data = predict.mollusc.df7.6,
aes(x=pH_delta, ymin=fit-se.fit, ymax=fit+se.fit),
linetype=0, alpha=0.1, fill="#2ca25f") +
geom_line(data = predict.mollusc.df7.6,
aes(x=pH_delta, y=fit),
col="gray45", linetype=1) +
geom_label(aes(x=-.3, y=1.1,
label=paste("Model with pH ≥7.6: χ2 p-value =", round(Anova(model.mollusc7.6)[,"Pr(>Chisq)"], digits =3), sep=" ")),
colour="gray40", alpha=0.1, fill="#2ca25f", size=3))
Anova(model.mollusc)
summary(model.mollusc)
(plot.mollusc <-
ggplot() +
geom_jitter(data=drop_na(data.fert, w) %>%
filter(phylum=="Mollusc"), aes(x=pH_delta, y=ave_fert_proport), size=1.2, width=0.03, col="#0571b0") +
ggtitle("D. Mollusc") +
xlab("Delta pH") + ylab(NULL) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5, size=13, colour="gray30")) +
coord_cartesian(ylim = c(0, 1.1), xlim =c(-2,0)) +
geom_ribbon(data = predict.mollusc.df,
aes(x=pH_delta, ymin=fit-se.fit, ymax=fit+se.fit),
linetype=9, alpha=0.3, fill="#fff2ae") +
geom_line(data = predict.mollusc.df, aes(x=pH_delta, y=fit),
col="gray45", linetype=2) +
theme(legend.position = "none") +
geom_label(aes(x=-1.5, y=0.8), label=paste("Model with full pH range: χ2 p-value =",
round(Anova(model.mollusc)[,"Pr(>Chisq)"], digits =4), sep=" "),
colour="gray40", size=3, alpha=0.3, fill="#fff2ae") +
geom_ribbon(data = predict.mollusc.df7.6,
aes(x=pH_delta, ymin=fit-se.fit, ymax=fit+se.fit),
linetype=0, alpha=0.1, fill="#2ca25f") +
geom_line(data = predict.mollusc.df7.6,
aes(x=pH_delta, y=fit),
col="gray45", linetype=1) +
geom_label(aes(x=-.3, y=1.1,
label=paste("Model with pH ≥7.6: χ2 p-value =", round(Anova(model.mollusc7.6)[,"Pr(>Chisq)"], digits =3), sep=" ")),
colour="gray40", alpha=0.1, fill="#2ca25f", size=3))
all.plots <- ggarrange(plot.cnidarian + ylab(NULL) + xlab(NULL),  plot.echino + ylab(NULL) + xlab(NULL), plot.mollusc, ncol=1, nrow=3)
annotate_figure(all.plots, left = text_grob("Proportion Fertilization Success", color = "gray20", rot = 90))
png(file = "fertilization-by-phylum-20210308.png", width = 500, height=800)
annotate_figure(all.plots, left = text_grob("Proportion Fertilization Success", color = "gray20", rot = 90))
dev.off()
(plot.cnidarian <- ggplot() +
geom_jitter(data=drop_na(data.fert, w) %>%
filter(phylum=="Cnidarian"), aes(x=pH_delta, y=ave_fert_proport), size=1.2, width=0.03, col="#ca0020") +
ggtitle("B. Cnidarian") +
xlab(NULL) + ylab("Proportion fertilization success") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5, size=13, colour="gray30")) +
coord_cartesian(ylim = c(0, 1.1), xlim =c(-2,0)) +
geom_ribbon(data = predict.cnidarian.df, aes(x=pH_delta, ymin=fit-se.fit, ymax=fit+se.fit),linetype=0, alpha=0.1, fill="#2ca25f") +
geom_line(data = predict.cnidarian.df, aes(x=pH_delta, y=fit), col="gray45", linetype=1) +
geom_label(aes(x=-1.5, y=0.83,
label=paste("χ2 p-value =", round(Anova(model.cnidarian)[,"Pr(>Chisq)"], digits = 3), sep=" ")),
colour="gray40", alpha=0.1, size=5, fill="#2ca25f", size=3))
(plot.echino <- ggplot() +
geom_jitter(data=drop_na(data.fert, w) %>%
filter(phylum=="Echinoderm"), aes(x=pH_delta, y=ave_fert_proport), size=1.2, width=0.03, col="#92c5de") +
ggtitle("C. Echinoderm") +
xlab("Delta pH") + ylab("Proportion fertilization success") +
theme_minimal() +
coord_cartesian(ylim = c(0, 1.1), xlim =c(-2,0)) +
theme(plot.title = element_text(hjust = 0.5, size=13, colour="gray30")) +
geom_ribbon(data = predict.echinoderm.df,
aes(x=pH_delta, ymin=fit-se.fit, ymax=fit+se.fit),
linetype=9, alpha=0.3, fill="#fff2ae") +
geom_line(data = predict.echinoderm.df, aes(x=pH_delta, y=fit),
col="gray45", linetype=2) +
theme(legend.position = "none") +
geom_label(aes(x=-1, y=0.3), label=paste("Model with full pH range: χ2 p-value =",
round(Anova(model.echinoderm)[,"Pr(>Chisq)"], digits =4), sep=" "),
colour="gray40", size=5, alpha=0.3, fill="#fff2ae") +
geom_ribbon(data = predict.echinoderm.df7.6,
aes(x=pH_delta, ymin=fit-se.fit, ymax=fit+se.fit),
linetype=0, alpha=0.1, fill="#2ca25f") +
geom_line(data = predict.echinoderm.df7.6,
aes(x=pH_delta, y=fit),
col="gray45", linetype=1) +
geom_label(aes(x=-.87, y=0.78,
label=paste("Model with pH ≥7.6: χ2 p-value =", round(Anova(model.echinoderm7.6)[,"Pr(>Chisq)"], digits =3), sep=" ")),
colour="gray40", size=5, alpha=0.1, fill="#2ca25f"))
(plot.echino <- ggplot() +
geom_jitter(data=drop_na(data.fert, w) %>%
filter(phylum=="Echinoderm"), aes(x=pH_delta, y=ave_fert_proport), size=1.2, width=0.03, col="#92c5de") +
ggtitle("C. Echinoderm") +
xlab("Delta pH") + ylab("Proportion fertilization success") +
theme_minimal() +
coord_cartesian(ylim = c(0, 1.1), xlim =c(-2,0)) +
theme(plot.title = element_text(hjust = 0.5, size=13, colour="gray30")) +
geom_ribbon(data = predict.echinoderm.df,
aes(x=pH_delta, ymin=fit-se.fit, ymax=fit+se.fit),
linetype=9, alpha=0.3, fill="#fff2ae") +
geom_line(data = predict.echinoderm.df, aes(x=pH_delta, y=fit),
col="gray45", linetype=2) +
theme(legend.position = "none") +
geom_label(aes(x=-1, y=0.3), label=paste("Model with full pH range: χ2 p-value =",
round(Anova(model.echinoderm)[,"Pr(>Chisq)"], digits =4), sep=" "),
colour="gray40", size=5, alpha=0.3, fill="#fff2ae") +
geom_ribbon(data = predict.echinoderm.df7.6,
aes(x=pH_delta, ymin=fit-se.fit, ymax=fit+se.fit),
linetype=0, alpha=0.1, fill="#2ca25f") +
geom_line(data = predict.echinoderm.df7.6,
aes(x=pH_delta, y=fit),
col="gray45", linetype=1) +
geom_label(aes(x=-.97, y=0.78,
label=paste("Model with pH ≥7.6: χ2 p-value =", round(Anova(model.echinoderm7.6)[,"Pr(>Chisq)"], digits =3), sep=" ")),
colour="gray40", size=5, alpha=0.1, fill="#2ca25f"))
(plot.echino <- ggplot() +
geom_jitter(data=drop_na(data.fert, w) %>%
filter(phylum=="Echinoderm"), aes(x=pH_delta, y=ave_fert_proport), size=1.2, width=0.03, col="#92c5de") +
ggtitle("C. Echinoderm") +
xlab("Delta pH") + ylab("Proportion fertilization success") +
theme_minimal() +
coord_cartesian(ylim = c(0, 1.1), xlim =c(-2,0)) +
theme(plot.title = element_text(hjust = 0.5, size=13, colour="gray30")) +
geom_ribbon(data = predict.echinoderm.df,
aes(x=pH_delta, ymin=fit-se.fit, ymax=fit+se.fit),
linetype=9, alpha=0.3, fill="#fff2ae") +
geom_line(data = predict.echinoderm.df, aes(x=pH_delta, y=fit),
col="gray45", linetype=2) +
theme(legend.position = "none") +
geom_label(aes(x=-1, y=0.3), label=paste("Model with full pH range: χ2 p-value =",
round(Anova(model.echinoderm)[,"Pr(>Chisq)"], digits =4), sep=" "),
colour="gray40", size=5, alpha=0.3, fill="#fff2ae") +
geom_ribbon(data = predict.echinoderm.df7.6,
aes(x=pH_delta, ymin=fit-se.fit, ymax=fit+se.fit),
linetype=0, alpha=0.1, fill="#2ca25f") +
geom_line(data = predict.echinoderm.df7.6,
aes(x=pH_delta, y=fit),
col="gray45", linetype=1) +
geom_label(aes(x=-1.7, y=0.78,
label=paste("Model with pH ≥7.6: χ2 p-value =", round(Anova(model.echinoderm7.6)[,"Pr(>Chisq)"], digits =3), sep=" ")),
colour="gray40", size=5, alpha=0.1, fill="#2ca25f"))
(plot.echino <- ggplot() +
geom_jitter(data=drop_na(data.fert, w) %>%
filter(phylum=="Echinoderm"), aes(x=pH_delta, y=ave_fert_proport), size=1.2, width=0.03, col="#92c5de") +
ggtitle("C. Echinoderm") +
xlab("Delta pH") + ylab("Proportion fertilization success") +
theme_minimal() +
coord_cartesian(ylim = c(0, 1.1), xlim =c(-2,0)) +
theme(plot.title = element_text(hjust = 0.5, size=13, colour="gray30")) +
geom_ribbon(data = predict.echinoderm.df,
aes(x=pH_delta, ymin=fit-se.fit, ymax=fit+se.fit),
linetype=9, alpha=0.3, fill="#fff2ae") +
geom_line(data = predict.echinoderm.df, aes(x=pH_delta, y=fit),
col="gray45", linetype=2) +
theme(legend.position = "none") +
geom_label(aes(x=-1, y=0.3), label=paste("Model with full pH range: χ2 p-value =",
round(Anova(model.echinoderm)[,"Pr(>Chisq)"], digits =4), sep=" "),
colour="gray40", size=5, alpha=0.3, fill="#fff2ae") +
geom_ribbon(data = predict.echinoderm.df7.6,
aes(x=pH_delta, ymin=fit-se.fit, ymax=fit+se.fit),
linetype=0, alpha=0.1, fill="#2ca25f") +
geom_line(data = predict.echinoderm.df7.6,
aes(x=pH_delta, y=fit),
col="gray45", linetype=1) +
geom_label(aes(x=-1.5, y=0.78,
label=paste("Model with pH ≥7.6: χ2 p-value =", round(Anova(model.echinoderm7.6)[,"Pr(>Chisq)"], digits =3), sep=" ")),
colour="gray40", size=5, alpha=0.1, fill="#2ca25f"))
(plot.echino <- ggplot() +
geom_jitter(data=drop_na(data.fert, w) %>%
filter(phylum=="Echinoderm"), aes(x=pH_delta, y=ave_fert_proport), size=1.2, width=0.03, col="#92c5de") +
ggtitle("C. Echinoderm") +
xlab("Delta pH") + ylab("Proportion fertilization success") +
theme_minimal() +
coord_cartesian(ylim = c(0, 1.1), xlim =c(-2,0)) +
theme(plot.title = element_text(hjust = 0.5, size=13, colour="gray30")) +
geom_ribbon(data = predict.echinoderm.df,
aes(x=pH_delta, ymin=fit-se.fit, ymax=fit+se.fit),
linetype=9, alpha=0.3, fill="#fff2ae") +
geom_line(data = predict.echinoderm.df, aes(x=pH_delta, y=fit),
col="gray45", linetype=2) +
theme(legend.position = "none") +
geom_label(aes(x=-1, y=0.3), label=paste("Model with full pH range: χ2 p-value =",
round(Anova(model.echinoderm)[,"Pr(>Chisq)"], digits =4), sep=" "),
colour="gray40", size=5, alpha=0.3, fill="#fff2ae") +
geom_ribbon(data = predict.echinoderm.df7.6,
aes(x=pH_delta, ymin=fit-se.fit, ymax=fit+se.fit),
linetype=0, alpha=0.1, fill="#2ca25f") +
geom_line(data = predict.echinoderm.df7.6,
aes(x=pH_delta, y=fit),
col="gray45", linetype=1) +
geom_label(aes(x=-1.2, y=0.78,
label=paste("Model with pH ≥7.6: χ2 p-value =", round(Anova(model.echinoderm7.6)[,"Pr(>Chisq)"], digits =3), sep=" ")),
colour="gray40", size=5, alpha=0.1, fill="#2ca25f"))
(plot.echino <- ggplot() +
geom_jitter(data=drop_na(data.fert, w) %>%
filter(phylum=="Echinoderm"), aes(x=pH_delta, y=ave_fert_proport), size=1.2, width=0.03, col="#92c5de") +
ggtitle("C. Echinoderm") +
xlab("Delta pH") + ylab("Proportion fertilization success") +
theme_minimal() +
coord_cartesian(ylim = c(0, 1.1), xlim =c(-2,0)) +
theme(plot.title = element_text(hjust = 0.5, size=13, colour="gray30")) +
geom_ribbon(data = predict.echinoderm.df,
aes(x=pH_delta, ymin=fit-se.fit, ymax=fit+se.fit),
linetype=9, alpha=0.3, fill="#fff2ae") +
geom_line(data = predict.echinoderm.df, aes(x=pH_delta, y=fit),
col="gray45", linetype=2) +
theme(legend.position = "none") +
geom_label(aes(x=-1, y=0.3), label=paste("Model with full pH range: χ2 p-value =",
round(Anova(model.echinoderm)[,"Pr(>Chisq)"], digits =4), sep=" "),
colour="gray40", size=5, alpha=0.3, fill="#fff2ae") +
geom_ribbon(data = predict.echinoderm.df7.6,
aes(x=pH_delta, ymin=fit-se.fit, ymax=fit+se.fit),
linetype=0, alpha=0.1, fill="#2ca25f") +
geom_line(data = predict.echinoderm.df7.6,
aes(x=pH_delta, y=fit),
col="gray45", linetype=1) +
geom_label(aes(x=-1.2, y=0.8,
label=paste("Model with pH ≥7.6: χ2 p-value =", round(Anova(model.echinoderm7.6)[,"Pr(>Chisq)"], digits =3), sep=" ")),
colour="gray40", size=5, alpha=0.1, fill="#2ca25f"))
(plot.echino <- ggplot() +
geom_jitter(data=drop_na(data.fert, w) %>%
filter(phylum=="Echinoderm"), aes(x=pH_delta, y=ave_fert_proport), size=1.2, width=0.03, col="#92c5de") +
ggtitle("C. Echinoderm") +
xlab("Delta pH") + ylab("Proportion fertilization success") +
theme_minimal() +
coord_cartesian(ylim = c(0, 1.1), xlim =c(-2,0)) +
theme(plot.title = element_text(hjust = 0.5, size=13, colour="gray30")) +
geom_ribbon(data = predict.echinoderm.df,
aes(x=pH_delta, ymin=fit-se.fit, ymax=fit+se.fit),
linetype=9, alpha=0.3, fill="#fff2ae") +
geom_line(data = predict.echinoderm.df, aes(x=pH_delta, y=fit),
col="gray45", linetype=2) +
theme(legend.position = "none") +
geom_label(aes(x=-1.5, y=0.3), label=paste("Model with full pH range: χ2 p-value =",
round(Anova(model.echinoderm)[,"Pr(>Chisq)"], digits =4), sep=" "),
colour="gray40", size=5, alpha=0.3, fill="#fff2ae") +
geom_ribbon(data = predict.echinoderm.df7.6,
aes(x=pH_delta, ymin=fit-se.fit, ymax=fit+se.fit),
linetype=0, alpha=0.1, fill="#2ca25f") +
geom_line(data = predict.echinoderm.df7.6,
aes(x=pH_delta, y=fit),
col="gray45", linetype=1) +
geom_label(aes(x=-1.2, y=0.8,
label=paste("Model with pH ≥7.6: χ2 p-value =", round(Anova(model.echinoderm7.6)[,"Pr(>Chisq)"], digits =3), sep=" ")),
colour="gray40", size=5, alpha=0.1, fill="#2ca25f"))
(plot.echino <- ggplot() +
geom_jitter(data=drop_na(data.fert, w) %>%
filter(phylum=="Echinoderm"), aes(x=pH_delta, y=ave_fert_proport), size=1.2, width=0.03, col="#92c5de") +
ggtitle("C. Echinoderm") +
xlab("Delta pH") + ylab("Proportion fertilization success") +
theme_minimal() +
coord_cartesian(ylim = c(0, 1.1), xlim =c(-2,0)) +
theme(plot.title = element_text(hjust = 0.5, size=13, colour="gray30")) +
geom_ribbon(data = predict.echinoderm.df,
aes(x=pH_delta, ymin=fit-se.fit, ymax=fit+se.fit),
linetype=9, alpha=0.3, fill="#fff2ae") +
geom_line(data = predict.echinoderm.df, aes(x=pH_delta, y=fit),
col="gray45", linetype=2) +
theme(legend.position = "none") +
geom_label(aes(x=-1.4, y=0.3), label=paste("Model with full pH range: χ2 p-value =",
round(Anova(model.echinoderm)[,"Pr(>Chisq)"], digits =4), sep=" "),
colour="gray40", size=5, alpha=0.3, fill="#fff2ae") +
geom_ribbon(data = predict.echinoderm.df7.6,
aes(x=pH_delta, ymin=fit-se.fit, ymax=fit+se.fit),
linetype=0, alpha=0.1, fill="#2ca25f") +
geom_line(data = predict.echinoderm.df7.6,
aes(x=pH_delta, y=fit),
col="gray45", linetype=1) +
geom_label(aes(x=-1.2, y=0.8,
label=paste("Model with pH ≥7.6: χ2 p-value =", round(Anova(model.echinoderm7.6)[,"Pr(>Chisq)"], digits =3), sep=" ")),
colour="gray40", size=5, alpha=0.1, fill="#2ca25f"))
(plot.echino <- ggplot() +
geom_jitter(data=drop_na(data.fert, w) %>%
filter(phylum=="Echinoderm"), aes(x=pH_delta, y=ave_fert_proport), size=1.2, width=0.03, col="#92c5de") +
ggtitle("C. Echinoderm") +
xlab("Delta pH") + ylab("Proportion fertilization success") +
theme_minimal() +
coord_cartesian(ylim = c(0, 1.1), xlim =c(-2,0)) +
theme(plot.title = element_text(hjust = 0.5, size=13, colour="gray30")) +
geom_ribbon(data = predict.echinoderm.df,
aes(x=pH_delta, ymin=fit-se.fit, ymax=fit+se.fit),
linetype=9, alpha=0.3, fill="#fff2ae") +
geom_line(data = predict.echinoderm.df, aes(x=pH_delta, y=fit),
col="gray45", linetype=2) +
theme(legend.position = "none") +
geom_label(aes(x=-1.4, y=0.28), label=paste("Model with full pH range: χ2 p-value =",
round(Anova(model.echinoderm)[,"Pr(>Chisq)"], digits =4), sep=" "),
colour="gray40", size=5, alpha=0.3, fill="#fff2ae") +
geom_ribbon(data = predict.echinoderm.df7.6,
aes(x=pH_delta, ymin=fit-se.fit, ymax=fit+se.fit),
linetype=0, alpha=0.1, fill="#2ca25f") +
geom_line(data = predict.echinoderm.df7.6,
aes(x=pH_delta, y=fit),
col="gray45", linetype=1) +
geom_label(aes(x=-1.2, y=0.8,
label=paste("Model with pH ≥7.6: χ2 p-value =", round(Anova(model.echinoderm7.6)[,"Pr(>Chisq)"], digits =3), sep=" ")),
colour="gray40", size=5, alpha=0.1, fill="#2ca25f"))
(plot.echino <- ggplot() +
geom_jitter(data=drop_na(data.fert, w) %>%
filter(phylum=="Echinoderm"), aes(x=pH_delta, y=ave_fert_proport), size=1.2, width=0.03, col="#92c5de") +
ggtitle("C. Echinoderm") +
xlab("Delta pH") + ylab("Proportion fertilization success") +
theme_minimal() +
coord_cartesian(ylim = c(0, 1.1), xlim =c(-2,0)) +
theme(plot.title = element_text(hjust = 0.5, size=13, colour="gray30")) +
geom_ribbon(data = predict.echinoderm.df,
aes(x=pH_delta, ymin=fit-se.fit, ymax=fit+se.fit),
linetype=9, alpha=0.3, fill="#fff2ae") +
geom_line(data = predict.echinoderm.df, aes(x=pH_delta, y=fit),
col="gray45", linetype=2) +
theme(legend.position = "none") +
geom_label(aes(x=-1.4, y=0.29), label=paste("Model with full pH range: χ2 p-value =",
round(Anova(model.echinoderm)[,"Pr(>Chisq)"], digits =4), sep=" "),
colour="gray40", size=5, alpha=0.3, fill="#fff2ae") +
geom_ribbon(data = predict.echinoderm.df7.6,
aes(x=pH_delta, ymin=fit-se.fit, ymax=fit+se.fit),
linetype=0, alpha=0.1, fill="#2ca25f") +
geom_line(data = predict.echinoderm.df7.6,
aes(x=pH_delta, y=fit),
col="gray45", linetype=1) +
geom_label(aes(x=-1.2, y=0.8,
label=paste("Model with pH ≥7.6: χ2 p-value =", round(Anova(model.echinoderm7.6)[,"Pr(>Chisq)"], digits =3), sep=" ")),
colour="gray40", size=5, alpha=0.1, fill="#2ca25f"))
(plot.mollusc <-
ggplot() +
geom_jitter(data=drop_na(data.fert, w) %>%
filter(phylum=="Mollusc"), aes(x=pH_delta, y=ave_fert_proport), size=1.2, width=0.03, col="#0571b0") +
ggtitle("D. Mollusc") +
xlab("Delta pH") + ylab(NULL) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5, size=13, colour="gray30")) +
coord_cartesian(ylim = c(0, 1.1), xlim =c(-2,0)) +
geom_ribbon(data = predict.mollusc.df,
aes(x=pH_delta, ymin=fit-se.fit, ymax=fit+se.fit),
linetype=9, alpha=0.3, fill="#fff2ae") +
geom_line(data = predict.mollusc.df, aes(x=pH_delta, y=fit),
col="gray45", linetype=2) +
theme(legend.position = "none") +
geom_label(aes(x=-1.5, y=0.8), label=paste("Model with full pH range: χ2 p-value =",
round(Anova(model.mollusc)[,"Pr(>Chisq)"], digits =4), sep=" "),
colour="gray40", size=5, alpha=0.3, fill="#fff2ae") +
geom_ribbon(data = predict.mollusc.df7.6,
aes(x=pH_delta, ymin=fit-se.fit, ymax=fit+se.fit),
linetype=0, alpha=0.1, fill="#2ca25f") +
geom_line(data = predict.mollusc.df7.6,
aes(x=pH_delta, y=fit),
col="gray45", linetype=1) +
geom_label(aes(x=-.3, y=1.1,
label=paste("Model with pH ≥7.6: χ2 p-value =", round(Anova(model.mollusc7.6)[,"Pr(>Chisq)"], digits =3), sep=" ")),
colour="gray40", alpha=0.1, fill="#2ca25f", size=5))
(plot.mollusc <-
ggplot() +
geom_jitter(data=drop_na(data.fert, w) %>%
filter(phylum=="Mollusc"), aes(x=pH_delta, y=ave_fert_proport), size=1.2, width=0.03, col="#0571b0") +
ggtitle("D. Mollusc") +
xlab("Delta pH") + ylab(NULL) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5, size=13, colour="gray30")) +
coord_cartesian(ylim = c(0, 1.1), xlim =c(-2,0)) +
geom_ribbon(data = predict.mollusc.df,
aes(x=pH_delta, ymin=fit-se.fit, ymax=fit+se.fit),
linetype=9, alpha=0.3, fill="#fff2ae") +
geom_line(data = predict.mollusc.df, aes(x=pH_delta, y=fit),
col="gray45", linetype=2) +
theme(legend.position = "none") +
geom_label(aes(x=-1.5, y=0.8), label=paste("Model with full pH range: χ2 p-value =",
round(Anova(model.mollusc)[,"Pr(>Chisq)"], digits =4), sep=" "),
colour="gray40", size=5, alpha=0.3, fill="#fff2ae") +
geom_ribbon(data = predict.mollusc.df7.6,
aes(x=pH_delta, ymin=fit-se.fit, ymax=fit+se.fit),
linetype=0, alpha=0.1, fill="#2ca25f") +
geom_line(data = predict.mollusc.df7.6,
aes(x=pH_delta, y=fit),
col="gray45", linetype=1) +
geom_label(aes(x=-.4, y=1.1,
label=paste("Model with pH ≥7.6: χ2 p-value =", round(Anova(model.mollusc7.6)[,"Pr(>Chisq)"], digits =3), sep=" ")),
colour="gray40", alpha=0.1, fill="#2ca25f", size=5))
(plot.mollusc <-
ggplot() +
geom_jitter(data=drop_na(data.fert, w) %>%
filter(phylum=="Mollusc"), aes(x=pH_delta, y=ave_fert_proport), size=1.2, width=0.03, col="#0571b0") +
ggtitle("D. Mollusc") +
xlab("Delta pH") + ylab(NULL) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5, size=13, colour="gray30")) +
coord_cartesian(ylim = c(0, 1.1), xlim =c(-2,0)) +
geom_ribbon(data = predict.mollusc.df,
aes(x=pH_delta, ymin=fit-se.fit, ymax=fit+se.fit),
linetype=9, alpha=0.3, fill="#fff2ae") +
geom_line(data = predict.mollusc.df, aes(x=pH_delta, y=fit),
col="gray45", linetype=2) +
theme(legend.position = "none") +
geom_label(aes(x=-1.5, y=0.8), label=paste("Model with full pH range: χ2 p-value =",
round(Anova(model.mollusc)[,"Pr(>Chisq)"], digits =4), sep=" "),
colour="gray40", size=5, alpha=0.3, fill="#fff2ae") +
geom_ribbon(data = predict.mollusc.df7.6,
aes(x=pH_delta, ymin=fit-se.fit, ymax=fit+se.fit),
linetype=0, alpha=0.1, fill="#2ca25f") +
geom_line(data = predict.mollusc.df7.6,
aes(x=pH_delta, y=fit),
col="gray45", linetype=1) +
geom_label(aes(x=-.5, y=1.1,
label=paste("Model with pH ≥7.6: χ2 p-value =", round(Anova(model.mollusc7.6)[,"Pr(>Chisq)"], digits =3), sep=" ")),
colour="gray40", alpha=0.1, fill="#2ca25f", size=5))
(plot.mollusc <-
ggplot() +
geom_jitter(data=drop_na(data.fert, w) %>%
filter(phylum=="Mollusc"), aes(x=pH_delta, y=ave_fert_proport), size=1.2, width=0.03, col="#0571b0") +
ggtitle("D. Mollusc") +
xlab("Delta pH") + ylab(NULL) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5, size=13, colour="gray30")) +
coord_cartesian(ylim = c(0, 1.1), xlim =c(-2,0)) +
geom_ribbon(data = predict.mollusc.df,
aes(x=pH_delta, ymin=fit-se.fit, ymax=fit+se.fit),
linetype=9, alpha=0.3, fill="#fff2ae") +
geom_line(data = predict.mollusc.df, aes(x=pH_delta, y=fit),
col="gray45", linetype=2) +
theme(legend.position = "none") +
geom_label(aes(x=-1.4, y=0.8), label=paste("Model with full pH range: χ2 p-value =",
round(Anova(model.mollusc)[,"Pr(>Chisq)"], digits =4), sep=" "),
colour="gray40", size=5, alpha=0.3, fill="#fff2ae") +
geom_ribbon(data = predict.mollusc.df7.6,
aes(x=pH_delta, ymin=fit-se.fit, ymax=fit+se.fit),
linetype=0, alpha=0.1, fill="#2ca25f") +
geom_line(data = predict.mollusc.df7.6,
aes(x=pH_delta, y=fit),
col="gray45", linetype=1) +
geom_label(aes(x=-.5, y=1.1,
label=paste("Model with pH ≥7.6: χ2 p-value =", round(Anova(model.mollusc7.6)[,"Pr(>Chisq)"], digits =3), sep=" ")),
colour="gray40", alpha=0.1, fill="#2ca25f", size=5))
(plot.mollusc <-
ggplot() +
geom_jitter(data=drop_na(data.fert, w) %>%
filter(phylum=="Mollusc"), aes(x=pH_delta, y=ave_fert_proport), size=1.2, width=0.03, col="#0571b0") +
ggtitle("D. Mollusc") +
xlab("Delta pH") + ylab(NULL) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5, size=13, colour="gray30")) +
coord_cartesian(ylim = c(0, 1.1), xlim =c(-2,0)) +
geom_ribbon(data = predict.mollusc.df,
aes(x=pH_delta, ymin=fit-se.fit, ymax=fit+se.fit),
linetype=9, alpha=0.3, fill="#fff2ae") +
geom_line(data = predict.mollusc.df, aes(x=pH_delta, y=fit),
col="gray45", linetype=2) +
theme(legend.position = "none") +
geom_label(aes(x=-1.4, y=0.9), label=paste("Model with full pH range: χ2 p-value =",
round(Anova(model.mollusc)[,"Pr(>Chisq)"], digits =4), sep=" "),
colour="gray40", size=5, alpha=0.3, fill="#fff2ae") +
geom_ribbon(data = predict.mollusc.df7.6,
aes(x=pH_delta, ymin=fit-se.fit, ymax=fit+se.fit),
linetype=0, alpha=0.1, fill="#2ca25f") +
geom_line(data = predict.mollusc.df7.6,
aes(x=pH_delta, y=fit),
col="gray45", linetype=1) +
geom_label(aes(x=-.5, y=1.1,
label=paste("Model with pH ≥7.6: χ2 p-value =", round(Anova(model.mollusc7.6)[,"Pr(>Chisq)"], digits =3), sep=" ")),
colour="gray40", alpha=0.1, fill="#2ca25f", size=5))
all.plots <- ggarrange(plot.cnidarian + ylab(NULL) + xlab(NULL),  plot.echino + ylab(NULL) + xlab(NULL), plot.mollusc, ncol=1, nrow=3)
annotate_figure(all.plots, left = text_grob("Proportion Fertilization Success", color = "gray20", rot = 90))
png(file = "fertilization-by-phylum-20210308.png", width = 500, height=800)
annotate_figure(all.plots, left = text_grob("Proportion Fertilization Success", color = "gray20", rot = 90))
dev.off()
#all.plots <- ggarrange(plot.cnidarian + ylab(NULL),  plot.echino + ylab(NULL), plot.mollusc + rremove("y.text"), ncol=1, nrow=3)
png(file = "fertilization-by-phylum-20210308.png", width = 550, height=850)
annotate_figure(all.plots, left = text_grob("Proportion Fertilization Success", color = "gray20", rot = 90))
dev.off()
png(file = "fertilization-by-phylum-20210308.png", width = 550, height=850)
annotate_figure(all.plots, left = text_grob("Proportion Fertilization Success", color = "gray20", rot = 90))
dev.off()
(plot.cnidarian <- ggplot() +
geom_jitter(data=drop_na(data.fert, w) %>%
filter(phylum=="Cnidarian"), aes(x=pH_delta, y=ave_fert_proport), size=1.2, width=0.03, col="#ca0020") +
ggtitle("B. Cnidarian") +
xlab(NULL) + ylab("Proportion fertilization success") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5, size=13, colour="gray30")) +
coord_cartesian(ylim = c(0, 1.1), xlim =c(-2,0)) +
geom_ribbon(data = predict.cnidarian.df, aes(x=pH_delta, ymin=fit-se.fit, ymax=fit+se.fit),linetype=0, alpha=0.1, fill="#2ca25f") +
geom_line(data = predict.cnidarian.df, aes(x=pH_delta, y=fit), col="gray45", linetype=1) +
geom_label(aes(x=-1, y=0.83,
label=paste("χ2 p-value =", round(Anova(model.cnidarian)[,"Pr(>Chisq)"], digits = 3), sep=" ")),
colour="gray40", alpha=0.1, size=5, fill="#2ca25f", size=3))
(plot.cnidarian <- ggplot() +
geom_jitter(data=drop_na(data.fert, w) %>%
filter(phylum=="Cnidarian"), aes(x=pH_delta, y=ave_fert_proport), size=1.2, width=0.03, col="#ca0020") +
ggtitle("B. Cnidarian") +
xlab(NULL) + ylab("Proportion fertilization success") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5, size=13, colour="gray30")) +
coord_cartesian(ylim = c(0, 1.1), xlim =c(-2,0)) +
geom_ribbon(data = predict.cnidarian.df, aes(x=pH_delta, ymin=fit-se.fit, ymax=fit+se.fit),linetype=0, alpha=0.1, fill="#2ca25f") +
geom_line(data = predict.cnidarian.df, aes(x=pH_delta, y=fit), col="gray45", linetype=1) +
geom_label(aes(x=-.85, y=0.83,
label=paste("χ2 p-value =", round(Anova(model.cnidarian)[,"Pr(>Chisq)"], digits = 3), sep=" ")),
colour="gray40", alpha=0.1, size=5, fill="#2ca25f", size=3))
(plot.cnidarian <- ggplot() +
geom_jitter(data=drop_na(data.fert, w) %>%
filter(phylum=="Cnidarian"), aes(x=pH_delta, y=ave_fert_proport), size=1.2, width=0.03, col="#ca0020") +
ggtitle("B. Cnidarian") +
xlab(NULL) + ylab("Proportion fertilization success") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5, size=13, colour="gray30")) +
coord_cartesian(ylim = c(0, 1.1), xlim =c(-2,0)) +
geom_ribbon(data = predict.cnidarian.df, aes(x=pH_delta, ymin=fit-se.fit, ymax=fit+se.fit),linetype=0, alpha=0.1, fill="#2ca25f") +
geom_line(data = predict.cnidarian.df, aes(x=pH_delta, y=fit), col="gray45", linetype=1) +
geom_label(aes(x=-.8, y=0.83,
label=paste("χ2 p-value =", round(Anova(model.cnidarian)[,"Pr(>Chisq)"], digits = 3), sep=" ")),
colour="gray40", alpha=0.1, size=5, fill="#2ca25f", size=3))
all.plots <- ggarrange(plot.cnidarian + ylab(NULL) + xlab(NULL),  plot.echino + ylab(NULL) + xlab(NULL), plot.mollusc, ncol=1, nrow=3)
png(file = "fertilization-by-phylum-20210308.png", width = 550, height=850)
annotate_figure(all.plots, left = text_grob("Proportion Fertilization Success", color = "gray20", rot = 90))
dev.off()
